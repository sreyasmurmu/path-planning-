<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>VEX Push Back – Autonomous Path Planner</title>

  <!-- React + Babel -->
  <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>

  <style>
    body {
      font-family: system-ui, sans-serif;
      background: #f8fafc;
      margin: 0;
      padding: 20px;
    }

    h1 {
      font-size: 24px;
      margin-bottom: 10px;
    }

    .container {
      display: grid;
      grid-template-columns: 2fr 1fr;
      gap: 16px;
    }

    .card {
      background: white;
      border-radius: 8px;
      padding: 12px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }

    .field {
      position: relative;
      width: 100%;
      aspect-ratio: 1 / 1;
      border: 2px solid #111;
      cursor: crosshair;
    }

    .tile {
      position: absolute;
      width: 16.66%;
      height: 16.66%;
    }

    .robot {
      position: absolute;
      width: 12px;
      height: 12px;
      background: #16a34a;
      border-radius: 50%;
      transform: translate(-50%, 50%);
      z-index: 10;
    }

    .zone {
      position: absolute;
      width: 22px;
      height: 22px;
      background: #3b82f6;
      border-radius: 20%;
      transform: translate(-50%, 50%);
    }

    .object {
      position: absolute;
      width: 14px;
      height: 14px;
      background: #ef4444;
      border-radius: 50%;
      transform: translate(-50%, 50%);
    }

    .point {
      position: absolute;
      width: 8px;
      height: 8px;
      background: #7c3aed;
      border-radius: 50%;
      transform: translate(-50%, 50%);
      z-index: 20;
    }

    pre {
      background: #f1f5f9;
      padding: 10px;
      border-radius: 6px;
      overflow-x: auto;
    }

    button {
      padding: 8px 12px;
      border-radius: 6px;
      border: none;
      background: #dc2626;
      color: white;
      cursor: pointer;
    }
  </style>
</head>

<body>
  <div id="root"></div>

  <script type="text/babel">
    const FIELD_SIZE = 144;
    const TILE_COLORS = ["#d1d5db", "#e5e7eb"];

    const fieldObjects = [
      { x: 72, y: 72, type: "zone" },
      { x: 72, y: 120, type: "zone" },
      { x: 72, y: 24, type: "zone" },

      { x: 36, y: 72, type: "object" },
      { x: 108, y: 72, type: "object" },
      { x: 72, y: 36, type: "object" },
      { x: 72, y: 108, type: "object" }
    ];

    function App() {
      const [robotPose] = React.useState({ x: 18, y: 18 });
      const [points, setPoints] = React.useState([]);

      const handleClick = (e) => {
        const rect = e.currentTarget.getBoundingClientRect();
        const x = ((e.clientX - rect.left) / rect.width) * FIELD_SIZE;
        const y = (1 - (e.clientY - rect.top) / rect.height) * FIELD_SIZE;
        setPoints([...points, { x, y }]);
      };

      return (
        <>
          <h1>VEX Push Back – Advanced Path Planner</h1>

          <div className="container">
            <div className="card">
              <div className="field" onClick={handleClick}>
                {[...Array(6)].map((_, r) =>
                  [...Array(6)].map((_, c) => (
                    <div
                      key={`${r}-${c}`}
                      className="tile"
                      style={{
                        left: `${(c / 6) * 100}%`,
                        bottom: `${(r / 6) * 100}%`,
                        background: TILE_COLORS[(r + c) % 2]
                      }}
                    />
                  ))
                )}

                <div
                  className="robot"
                  style={{
                    left: `${(robotPose.x / FIELD_SIZE) * 100}%`,
                    bottom: `${(robotPose.y / FIELD_SIZE) * 100}%`
                  }}
                />

                {fieldObjects.map((o, i) => (
                  <div
                    key={i}
                    className={o.type}
                    style={{
                      left: `${(o.x / FIELD_SIZE) * 100}%`,
                      bottom: `${(o.y / FIELD_SIZE) * 100}%`
                    }}
                  />
                ))}

                {points.map((p, i) => (
                  <div
                    key={i}
                    className="point"
                    style={{
                      left: `${(p.x / FIELD_SIZE) * 100}%`,
                      bottom: `${(p.y / FIELD_SIZE) * 100}%`
                    }}
                  />
                ))}
              </div>
            </div>

            <div className="card">
              <h3>Controls</h3>
              <p>Click to add control points</p>
              <button onClick={() => setPoints([])}>Clear Path</button>
            </div>
          </div>

          <div className="card" style={{ marginTop: "16px" }}>
            <h3>Generated LemLib Path</h3>
            <pre>
{points.map(p =>
`chassis.follow(${p.x.toFixed(1)}, ${p.y.toFixed(1)});`
).join("\n")}
            </pre>
          </div>
        </>
      );
    }

    ReactDOM.createRoot(document.getElementById("root")).render(<App />);
  </script>
</body>
</html>
